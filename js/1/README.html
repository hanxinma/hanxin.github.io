<h1 id="My-RIME"><a href="#My-RIME" class="headerlink" title="My RIME"></a>My RIME</h1><p><img src="https://img.shields.io/github/license/LibreService/my_rime"></p>
<p>Chinese IME powered by <a href="https://github.com/rime/librime">RIME</a>.</p>
<p><a href="https://my-rime.vercel.app/">https://my-rime.vercel.app/</a></p>
<p>This is a <strong>STATIC</strong> website so you <strong>DON’T</strong> need to own a server to host it.</p>
<p>All computation is performed in browser, thanks to Web Assembly.</p>
<p>It’s also a <a href="https://web.dev/progressive-web-apps/">PWA</a>, so you can install it like a native App and use it <strong>OFFLINE</strong>.</p>
<p>If you want to distribute your own IME, see <a href="doc/customize.md">customize</a>.</p>
<p>If you want to deploy schemas dynamically (online, like how you deploy in Desktop&#x2F;Mobile platforms), see <a href="doc/deploy.md">deploy</a>.</p>
<h2 id="Self-host"><a href="#Self-host" class="headerlink" title="Self host"></a>Self host</h2><p>Download latest <a href="https://github.com/LibreService/my_rime/releases/download/latest/my-rime-dist.zip">artifact</a> built by GitHub Actions.</p>
<h2 id="Development-workflow"><a href="#Development-workflow" class="headerlink" title="Development workflow"></a>Development workflow</h2><p>My RIME can be built on Linux.</p>
<h3 id="Install-node"><a href="#Install-node" class="headerlink" title="Install node"></a>Install node</h3><p>You may use <a href="https://github.com/nvm-sh/nvm">nvm</a> to install node.</p>
<h3 id="Install-pnpm-and-dev-dependencies"><a href="#Install-pnpm-and-dev-dependencies" class="headerlink" title="Install pnpm and dev dependencies"></a>Install pnpm and dev dependencies</h3><pre><code class="sh">npm i -g pnpm
pnpm i
</code></pre>
<h3 id="Install-RIME-dependencies"><a href="#Install-RIME-dependencies" class="headerlink" title="Install RIME dependencies"></a>Install RIME dependencies</h3><pre><code class="sh">apt install libboost-dev \
  libboost-filesystem-dev \
  libboost-regex-dev \
  libboost-system-dev \
  libyaml-cpp-dev \
  libleveldb-dev \
  libmarisa-dev \
  libopencc-dev
</code></pre>
<h3 id="Install-emsdk"><a href="#Install-emsdk" class="headerlink" title="Install emsdk"></a>Install emsdk</h3><p><a href="https://emscripten.org/docs/getting_started/downloads.html">https://emscripten.org/docs/getting_started/downloads.html</a></p>
<h3 id="Get-submodule"><a href="#Get-submodule" class="headerlink" title="Get submodule"></a>Get submodule</h3><p>It’s not recommended to clone recursively, as many boost libs are not needed.</p>
<pre><code class="sh">pnpm run submodule
</code></pre>
<h3 id="Get-font"><a href="#Get-font" class="headerlink" title="Get font"></a>Get font</h3><p>Uncommon characters are rendered using<br><a href="https://github.com/Fitzgerald-Porthmouth-Koenigsegg/Plangothic-Project">遍黑体</a><br>and<br><a href="https://github.com/max32002/max-hana">花园明朝</a>.</p>
<pre><code class="sh">pnpm run font
</code></pre>
<h3 id="Build-wasm"><a href="#Build-wasm" class="headerlink" title="Build wasm"></a>Build wasm</h3><pre><code class="sh">pnpm run native
pnpm run schema
export ENABLE_LOGGING=ON # optional
pnpm run lib
pnpm run wasm
</code></pre>
<h3 id="Run-develop-server"><a href="#Run-develop-server" class="headerlink" title="Run develop server"></a>Run develop server</h3><pre><code class="sh">pnpm run dev
</code></pre>
<p>The app is accessible at <a href="http://localhost:5173/">http://localhost:5173</a></p>
<p>Optionally, go to <a href="http://localhost:5173/?debug=on">http://localhost:5173/?debug=on</a> or turn on <code>Advanced</code> switch so that you can send raw key sequences to librime,<br> e.g. <code>{Shift+Delete}</code>, <code>{Release+a}</code>. This feature is better used when you set <code>ENABLE_LOGGING=ON</code> in the previous step.</p>
<h3 id="Lint"><a href="#Lint" class="headerlink" title="Lint"></a>Lint</h3><pre><code class="sh">pnpm run lint:fix
</code></pre>
<h3 id="Check-type"><a href="#Check-type" class="headerlink" title="Check type"></a>Check type</h3><pre><code class="sh">pnpm run check
</code></pre>
<h3 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h3><pre><code class="sh">pnpm run build
</code></pre>
<h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><pre><code class="sh">pnpm run test
</code></pre>
<h3 id="Preview"><a href="#Preview" class="headerlink" title="Preview"></a>Preview</h3><pre><code class="sh">pnpm run preview
</code></pre>
<h3 id="Deploy-maintainer-only"><a href="#Deploy-maintainer-only" class="headerlink" title="Deploy (maintainer only)"></a>Deploy (maintainer only)</h3><pre><code class="sh"># publish IMEs
declare -a packages=(
  ... # targets output by pnpm run schema
)
for package in &quot;${packages[@]}&quot;; do
  pushd public/ime/$package
  npm publish
  popd
done

# set VERSION to avoid CDN and browser caching old version
export LIBRESERVICE_CDN=https://cdn.jsdelivr.net/npm/@libreservice/my-rime@VERSION/dist/
export RIME_CDN=https://cdn.jsdelivr.net/npm/@rime-contrib/

vercel build --prod
npm publish
vercel deploy --prebuilt --prod
</code></pre>
<h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><pre><code class="sh">docker build \
  --build-arg ENABLE_LOGGING=ON \
  -t my-rime .
docker run --name my-rime -d my-rime
</code></pre>
<p>Let’s say the IP address of the container is 172.17.0.2 (got by <code>docker inspect my-rime | grep IPAddress</code>), then My RIME is accessible at <a href="http://172.17.0.2/">http://172.17.0.2/</a>.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>AGPLv3+</p>
